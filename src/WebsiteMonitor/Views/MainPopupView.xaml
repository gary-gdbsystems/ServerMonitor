<UserControl x:Class="WebsiteMonitor.Views.MainPopupView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:WebsiteMonitor.ViewModels"
             xmlns:views="clr-namespace:WebsiteMonitor.Views"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=vm:MainViewModel}"
             Width="480" Height="500"
             Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}">

    <Border BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
            BorderThickness="1"
            CornerRadius="4">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0"
                    Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                    BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                    BorderThickness="0,0,0,1"
                    Padding="12,10">
                <Grid>
                    <TextBlock Text="Development Servers"
                               FontWeight="SemiBold"
                               FontSize="14"
                               VerticalAlignment="Center"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="↻"
                                Command="{Binding RefreshCommand}"
                                Width="28" Height="28"
                                FontSize="14"
                                Margin="0,0,4,0"
                                ToolTip="Refresh server list"/>
                        <Button Content="✕"
                                Command="{Binding ExitCommand}"
                                Width="28" Height="28"
                                FontSize="12"
                                ToolTip="Exit application"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Server List -->
            <ScrollViewer Grid.Row="1"
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled">
                <ItemsControl ItemsSource="{Binding ServersView}" Padding="8">
                    <ItemsControl.GroupStyle>
                        <GroupStyle>
                            <GroupStyle.HeaderTemplate>
                                <DataTemplate>
                                    <Border Background="#3B82F6" Padding="8,4" Margin="0,8,0,4" CornerRadius="4">
                                        <TextBlock Text="{Binding Name}" Foreground="White" FontWeight="Bold"/>
                                    </Border>
                                </DataTemplate>
                            </GroupStyle.HeaderTemplate>
                        </GroupStyle>
                    </ItemsControl.GroupStyle>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate DataType="{x:Type vm:ServerRowViewModel}">
                            <views:ServerRowView Margin="0,0,0,8"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <!-- Empty State -->
            <TextBlock Grid.Row="1"
                       Text="No development servers running"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                       FontSize="13">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Servers.Count}" Value="0">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>

            <!-- Footer -->
            <Border Grid.Row="2"
                    Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                    BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                    BorderThickness="0,1,0,0"
                    Padding="12,8">
                <TextBlock Text="{Binding StatusText}"
                           FontSize="12"
                           Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Border>
        </Grid>
    </Border>
</UserControl>
